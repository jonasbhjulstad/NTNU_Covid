#include <@NV_CL_PRNG_TYPE@.cl>
#define UINT_MAX        0xffffffff


void UniformSample_f32(@NV_CL_PRNG_TYPE@_state* state, float min, float max, uint N, float* res)
{
    for (int i = 0; i < N; i++)
    {
        @NV_CL_PRNG_TYPE@_advance(state);
        res[i] = state->res*@NV_CL_PRNG_TYPE@_FLOAT_MULTI;
    }
}

uint BinomialSample_f32(@NV_CL_PRNG_TYPE@_state* state, const uint N, float p)
{
    float uSample = 1.f;
    uint count = 0;
    for (uint i = 0; i < N; i++)
    {
        UniformSample_f32(state, 0, 1, 1, &uSample);
        if (uSample < p)
        {
            count++;
        }
    }
    return count;
}

void PoissonSample_f32(@NV_CL_PRNG_TYPE@_state* state, float lambda, float* res)
{
    float x = 0;
    float p = -lambda;
    float s = 1;
    float u;
    // printf("p: %e, lbd: %f", p, lambda);
    while(s > p)
    {
        UniformSample_f32(state, 0, 1, 1, &u);
        x++;
        s = s + log(u);
    }
    // printf("x: %f\n", x);
    res[0] = x-1;
}